Notes for the SHEDS Brook Trout Occupancy Model
===============================================

The following notes were generated by going through the original model code in the repo: [Conte-Ecology/Northeast_Bkt_Occupancy](https://github.com/Conte-Ecology/Northeast_Bkt_Occupancy).

## Data Files

The `Data/` directory contains:

```
covariates.RData    # Code/retrieve_covariates.R, Code/retrieve.R
data_clean.RData    # Code/prepare_data.R
fit.RData           # Code/prepare_data.R
means.RData         # Code/prepare_data.R
valid.RData         # Code/prepare_data.R
vars.RData          # Code/prepare_data.R
fit_data_out.RData  # fit_occupancy_models.Rmd
```

## Output Files

The `Output/` directory contains:

```
AUC_plots.png                   # validation.Rmd
AUC_valid_plots.png             # validation.Rmd
Forest_Effects.png              # validation.Rmd
July_Temp_Effect.png            # validation.Rmd
Occupancy_Predictions.RData     # validation.Rmd
Threshold_Predictions.RData     # validation.Rmd
occupancy_dForest_50pct_map.png # validation.Rmd
occupancy_map.png               # validation.Rmd
scatterplot_matrix.png          # ????
validation_error_table.rds      # validation.Rmd
predictions.RData               # model_predictions.Rmd, Code/Northeast_Occupancy_Flow.Rmd, Code/Northeast_Occupancy_Temp.Rmd, Code/Northeast_Occupancy_Temp_Compare.Rmd
```

## Scripts

```
Code/retrieve_covariates.R, Code/retrieve.R
Code/prepare_data.R
fit_occupancy_models.Rmd

validation.Rmd
```

## Workflow

### Step 1: Fetch Covariates

The scripts `retrieve.R` and `retrieve_covariates.R` are similar, but `retrieve.R` appears to supercede `retrieve_covariates.R`.

```
Rscript retrieve.R
```

The `df_covariates` data frame contains the following columns:

```
# id columns
featureid
huc12
huc4
huc8
huc10

zone
riparian_distance_ft

# upstream riparian (200 ft) covariates
forest

# upstream, non-riparian covariates
agriculture
alloffnet
allonnet
ann_tmax_c
ann_tmin_c
AreaSqKM
deg_barr_1
deg_barr_2
deg_barr_3
deg_barr_4
deg_barr_5
deg_barr_6
deg_barr_7
deg_barr_all
dep_no3_2011
dep_so4_2011
devel_hi
devel_low
devel_med
devel_opn
developed
drainageclass
elevation
forest_all( = forest)
forest_decid
forest_evgrn
forest_mixed
fwsopenwater
fwswetlands
herbaceous
hydrogroup_a
hydrogroup_ab
hydrogroup_cd
hydrogroup_d1
hydrogroup_d4
impervious
openoffnet
openonnet
percent_sandy
slope_pcnt
surfcoarse
tree_canopy
undev_forest
water
wetland

# monthly precip
jan_prcp_mm
feb_prcp_mm
mar_prcp_mm
apr_prcp_mm
may_prcp_mm
jun_prcp_mm
jul_prcp_mm
aug_prcp_mm
sep_prcp_mm
oct_prcp_mm
nov_prcp_mm
dec_prcp_mm

# derived seasonal precip
ann_prcp
winter_prcp_mm
spring_prcp_mm
summer_prcp_mm
fall_prcp_mm
```

## Step 2: Prepare Input Data Frame

Generate input data frame

```
Rscript Code/prepare-data.R
```

Standardize covariates (center and scale)
Split dataset by HUC10 for calibration (80%) and validation (20%)

Final input data frame columns

```
# id/groupings
featureid
huc8
huc10
huc12
fhuc8  # factor(huc8)
fhuc10 # factor(huc10)

# location
latitude
longitude

# observed presence/absence
pres

# covariates - drainage area, land use
agriculture     # upstream, not riparian
allonnet        # upstream, not riparian
area            # < 200 km2
devel_hi        # upstream, not riparian
elevation       # upstream, not riparian
forest          # upstream, 200 ft riparian
surfcoarse      # upstream, not riparian

# covariates - temp-model output
meanJulyTemp
meanSummerTemp
meanDays.18     # < 300 days/year

# covariates - precipitation
prcp            # annual
winter_prcp_mm  # Jan + Feb + Mar
spring_prcp_mm  # Apr + May + Jun
summer_prcp_mm  # Jul + Aug + Sep
fall_prcp_mm    # Oct + Nov + Dec
```
