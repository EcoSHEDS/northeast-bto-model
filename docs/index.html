<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>EcoSHEDS Northeast Brook Trout Occupancy Model</title>
  <meta name="description" content="Documentation for the EcoSHEDS Northeast Brook Trout Occupancy Model." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="EcoSHEDS Northeast Brook Trout Occupancy Model" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Documentation for the EcoSHEDS Northeast Brook Trout Occupancy Model." />
  <meta name="github-repo" content="walkerjeffd/sheds-bto-model" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="EcoSHEDS Northeast Brook Trout Occupancy Model" />
  
  <meta name="twitter:description" content="Documentation for the EcoSHEDS Northeast Brook Trout Occupancy Model." />
  

<meta name="author" content="Jeffrey D. Walker, Benjamin Letcher" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="data-sources.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CBK3R7N2WQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CBK3R7N2WQ');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 1em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EcoSHEDS BTO Model</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#model-summary"><i class="fa fa-check"></i><b>1.1</b> Model Summary</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#documentation"><i class="fa fa-check"></i><b>1.2</b> Documentation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#source-code"><i class="fa fa-check"></i><b>1.3</b> Source Code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data Sources</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#catchment-delineation"><i class="fa fa-check"></i><b>2.1</b> Catchment Delineation</a></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#huc8-basins"><i class="fa fa-check"></i><b>2.2</b> HUC8 Basins</a></li>
<li class="chapter" data-level="2.3" data-path="data-sources.html"><a href="data-sources.html#observation-data"><i class="fa fa-check"></i><b>2.3</b> Observation Data</a></li>
<li class="chapter" data-level="2.4" data-path="data-sources.html"><a href="data-sources.html#stream-temperature"><i class="fa fa-check"></i><b>2.4</b> Stream Temperature</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="model-development.html"><a href="model-development.html"><i class="fa fa-check"></i><b>3</b> Model Development</a>
<ul>
<li class="chapter" data-level="3.1" data-path="model-development.html"><a href="model-development.html#model-definition"><i class="fa fa-check"></i><b>3.1</b> Model Definition</a></li>
<li class="chapter" data-level="3.2" data-path="model-development.html"><a href="model-development.html#model-history"><i class="fa fa-check"></i><b>3.2</b> Model History</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html"><i class="fa fa-check"></i><b>4</b> Calibration and Validation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html#dataset-split"><i class="fa fa-check"></i><b>4.1</b> Dataset Split</a></li>
<li class="chapter" data-level="4.2" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html#calibration"><i class="fa fa-check"></i><b>4.2</b> Calibration</a></li>
<li class="chapter" data-level="4.3" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html#validation"><i class="fa fa-check"></i><b>4.3</b> Validation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="predictions.html"><a href="predictions.html"><i class="fa fa-check"></i><b>5</b> Predictions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="predictions.html"><a href="predictions.html#full-calibration"><i class="fa fa-check"></i><b>5.1</b> Full Calibration</a></li>
<li class="chapter" data-level="5.2" data-path="predictions.html"><a href="predictions.html#prediction-metrics"><i class="fa fa-check"></i><b>5.2</b> Prediction Metrics</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="downloads.html"><a href="downloads.html"><i class="fa fa-check"></i><b>6</b> Downloads</a>
<ul>
<li class="chapter" data-level="6.1" data-path="downloads.html"><a href="downloads.html#model-predictions"><i class="fa fa-check"></i><b>6.1</b> Model Predictions</a></li>
<li class="chapter" data-level="6.2" data-path="downloads.html"><a href="downloads.html#catchment-delineation-1"><i class="fa fa-check"></i><b>6.2</b> Catchment Delineation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="history.html"><a href="history.html"><i class="fa fa-check"></i><b>7</b> History</a>
<ul>
<li class="chapter" data-level="7.1" data-path="history.html"><a href="history.html#versioning"><i class="fa fa-check"></i><b>7.1</b> Versioning</a></li>
<li class="chapter" data-level="7.2" data-path="history.html"><a href="history.html#change-log"><i class="fa fa-check"></i><b>7.2</b> Change Log</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EcoSHEDS Northeast Brook Trout Occupancy Model</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">EcoSHEDS Northeast Brook Trout Occupancy Model</h1>
<p class="author"><em><a href="https://walkerenvres.com">Jeffrey D. Walker</a>, <a href="https://www.usgs.gov/staff-profiles/benjamin-h-letcher">Benjamin Letcher</a></em></p>
<p class="date"><em>v2.0.0 (July 8, 2022)</em></p>
</div>
<div id="intro" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Section 1</span> Introduction<a href="index.html#intro" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The northeast brook trout occupancy model predicts the occupancy probability of eastern brook trout based on estimated stream temperatures across a high resolution catchment delineation for the northeast U.S. (Maine to Virginia). This model is developed and maintained as part of the <a href="https://www.usgs.gov/apps/ecosheds/">EcoSHEDS</a> project.</p>
<div id="model-summary" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Model Summary<a href="index.html#model-summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The occupancy model is a logistic linear mixed effects model for predicting occupancy probability based on estimated stream temperature. The primary model input is the estimated mean July stream temperature generated by the <a href="https://ecosheds.org/models/stream-temperature/latest/">EcoSHEDS Northeast Stream Temperature Model</a> and averaged over all years from 1980 to present. The model also includes a varying intercept (random effect) based on the HUC8<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> basin containing each catchment to account for regional variations in occupancy not explained by stream temperature. Like the EcoSHEDS stream temperature model, the occupancy model domain is based on the <a href="https://conte-ecology.github.io/shedsGisData/#the-national-hydrography-dataset-high-resolution-delineation-version-2-nhdhrdv2">EcoSHEDS Northeast Catchment Delineation</a>.</p>
<p>The occupancy model was calibrated using presence/absence data compiled from multiple state agencies across the region.</p>
<div class="figure"><span style="display:block;" id="fig:intro-obs-map"></span>
<img src="sheds-bto-model_files/figure-html/intro-obs-map-1.png" alt="Map of Presence/Absence by Catchment" width="672" />
<p class="caption">
Figure 1.1: Map of Presence/Absence by Catchment
</p>
</div>
<p>The model was validating by splitting the observed presence/absence data into independent training and testing subsets, calibrating the model to the training data, and then comparing the model performance between the two subsets. The validation confirmed that the model structure is not susceptible to over-fitting. Following validation, the model was re-calibrated using all available observation data in order to maximize the amount of information used to generate the final predictions. The following table summarizes the model performance for each dataset.</p>
<table>
<thead>
<tr class="header">
<th align="left">Metric</th>
<th align="right">Calibration</th>
<th align="right">Validation</th>
<th align="right">Full (Prediction)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Accuracy</td>
<td align="right">0.832</td>
<td align="right">0.809</td>
<td align="right">0.832</td>
</tr>
<tr class="even">
<td align="left">Sensitivity</td>
<td align="right">0.897</td>
<td align="right">0.844</td>
<td align="right">0.894</td>
</tr>
<tr class="odd">
<td align="left">Specificity</td>
<td align="right">0.712</td>
<td align="right">0.748</td>
<td align="right">0.717</td>
</tr>
<tr class="even">
<td align="left">Pos Pred Value</td>
<td align="right">0.852</td>
<td align="right">0.857</td>
<td align="right">0.853</td>
</tr>
<tr class="odd">
<td align="left">Neg Pred Value</td>
<td align="right">0.790</td>
<td align="right">0.727</td>
<td align="right">0.786</td>
</tr>
<tr class="even">
<td align="left">Precision</td>
<td align="right">0.852</td>
<td align="right">0.857</td>
<td align="right">0.853</td>
</tr>
<tr class="odd">
<td align="left">Recall</td>
<td align="right">0.897</td>
<td align="right">0.844</td>
<td align="right">0.894</td>
</tr>
<tr class="even">
<td align="left">F1</td>
<td align="right">0.874</td>
<td align="right">0.850</td>
<td align="right">0.873</td>
</tr>
<tr class="odd">
<td align="left">Prevalence</td>
<td align="right">0.649</td>
<td align="right">0.642</td>
<td align="right">0.648</td>
</tr>
<tr class="even">
<td align="left">Detection Rate</td>
<td align="right">0.582</td>
<td align="right">0.542</td>
<td align="right">0.579</td>
</tr>
<tr class="odd">
<td align="left">Detection Prevalence</td>
<td align="right">0.684</td>
<td align="right">0.632</td>
<td align="right">0.679</td>
</tr>
<tr class="even">
<td align="left">Balanced Accuracy</td>
<td align="right">0.805</td>
<td align="right">0.796</td>
<td align="right">0.806</td>
</tr>
</tbody>
</table>
<p>Predicted occupancy probabilities were generated for each catchment under both historical conditions as well as for a series of simple climate change scenarios (e.g., +2, +4, +6 degC air temperature). Additional metrics were also computed to evaluate the vulnerability of brook trout occupancy within each catchment to climate change (e.g., the maximum air temperature increase that would result in 30, 50, or 70% occupancy). Model predictions were only generated for catchments with cumulative drainage areas less than 200 km<sup>2</sup> (i.e., lower order streams) due to the complexity of predicting stream temperatures in larger rivers.</p>
<div class="figure"><span style="display:block;" id="fig:intro-map-prob"></span>
<img src="sheds-bto-model_files/figure-html/intro-map-prob-1.png" alt="Predicted Occupancy Probabilities under Historical and Future Climate Change Scenarios" width="672" />
<p class="caption">
Figure 1.2: Predicted Occupancy Probabilities under Historical and Future Climate Change Scenarios
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:intro-map-max"></span>
<img src="sheds-bto-model_files/figure-html/intro-map-max-1.png" alt="Predicted Max. Air Temperature Increases to Achieve Varying Occupancy Probabilities" width="672" />
<p class="caption">
Figure 1.3: Predicted Max. Air Temperature Increases to Achieve Varying Occupancy Probabilities
</p>
</div>
<p>The predicted occupancy probabilities along with stream temperature predictions and various catchment characteristics can be found in the <a href="https://www.usgs.gov/apps/ecosheds/ice-northeast/">Northeast Interactive Catchment Explorer (ICE)</a>. Data files containing the predictions are also available for download (see <a href="downloads.html#downloads">Downloads</a>).</p>
<p>The model is periodically updated when either new observation data are available, or following each update of the northeast stream temperature model. Currently, updates are being performed annually, usually in the fall.</p>
</div>
<div id="documentation" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Documentation<a href="index.html#documentation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The documentation is divided into the following sections:</p>
<ol style="list-style-type: decimal">
<li><a href="index.html#intro">Introduction</a> provides an overview the model and its documentation</li>
<li><a href="data-sources.html#data-sources">Data Sources</a> describes the data sources and data processing steps used to generate the model inputs and observed data</li>
<li><a href="model-development.html#model-development">Model Development</a> describes the model structure and implementation</li>
<li><a href="calibration-and-validation.html#calibration-and-validation">Calibration and Validation</a> summarizes the model calibration and validation</li>
<li><a href="predictions.html#predictions">Predictions</a> describes the model prediction scenarios and metrics</li>
<li><a href="downloads.html#downloads">Downloads</a> provides links to download the model predictions</li>
<li><a href="history.html#history">History</a> contains a list of changes to the model over time</li>
</ol>
</div>
<div id="source-code" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Source Code<a href="index.html#source-code" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The source code for the model itself and this documentation is available in the Github repository <a href="https://github.com/EcoSHEDS/northeast-bto-model">walkerjeffd/sheds-bto-model</a>. Each version of the model will be included under the list of <a href="https://github.com/EcoSHEDS/northeast-bto-model/releases">Releases</a>.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>8-digit Hydrologic Unit Code (HUC)<a href="index.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="data-sources.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
